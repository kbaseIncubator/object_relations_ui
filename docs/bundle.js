!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(5);function i(e,t,n){var i,a,s,d={};if(void 0!==n?(d=t,o.array(n)?i=n:o.primitive(n)?a=n:n&&n.sel&&(i=[n])):void 0!==t&&(o.array(t)?i=t:o.primitive(t)?a=t:t&&t.sel?i=[t]:d=t),void 0!==i)for(s=0;s<i.length;++s)o.primitive(i[s])&&(i[s]=r.vnode(void 0,void 0,void 0,i[s],void 0));return"s"!==e[0]||"v"!==e[1]||"g"!==e[2]||3!==e.length&&"."!==e[3]&&"#"!==e[3]||function e(t,n,r){if(t.ns="http://www.w3.org/2000/svg","foreignObject"!==r&&void 0!==n)for(var o=0;o<n.length;++o){var i=n[o].data;void 0!==i&&e(i,n[o].children,n[o].sel)}}(d,i,e),r.vnode(e,d,i,a,void 0)}t.h=i,t.default=i},function(e,t,n){const r=n(21).init([n(6).default,n(7).default,n(8).default,n(9).default,n(10).default,n(11).default]),o=n(0).default;e.exports=function(e){const t=e.view;return e._viewArgs=[],e._vnode=r(document.createElement("div"),o("div")),e._render=function(){const n=r(e._vnode,t.apply(e,e._viewArgs));for(let t in n)e._vnode[t]=n[t];return e._vnode},e.view=function(){return e._viewArgs=arguments,e._render()},e}},function(e,t){e.exports=function(e,t){if(e)return"function"==typeof t?t():t;return""}},function(e,t,n){const r=n(0).default,o=n(2),i=n(1),{HomologTable:a}=n(12);function s(){const e=this,t=e=>r("div.container.px2.max-width-3",e);return e.pendingInput?t([r("p.muted","Waiting for input...")]):t([o(e.error,()=>r("p.error",e.error)),r("div",[e.homologTable.view()])])}window.addEventListener("message",function(e){let t;if(!t)return;console.log("Received message:",t);try{t=JSON.parse(e.data)}catch(e){return console.error("Unable to parse data: "+String(t)),void console.error(e)}if(!(t.method in window._messageHandlers))return console.error("Unknown method: "+t.method),void console.log("Docs: https://github.com/kbaseincubator/object_relations_ui");window._messageHandlers[t.method](t.params)},!1),window._env={kbaseEndpoint:"https://ci.kbase.us/services",kbaseRoot:"https://ci.kbase.us",sketchURL:"https://ci.kbase.us/dynserv/2ef8cc90ad4caf1caa86be919d326e7b3ec90435.sketch-service",relEngURL:"https://ci.kbase.us/services/relation_engine_api",authToken:null},document._page=i({pendingInput:!0,loading:!1,obj:{},homologTable:a(),setUpa(e){this.pendingInput=!1,this.homologTable.fetch(e),this._render()},view:s}),window._messageHandlers={setConfig:function({config:e}){console.log("Setting config:",e),window._env=Object.assign(window._env,e),e.upa&&document._page.setUpa(e.upa)}},document.body.appendChild(document._page._render().elm)},function(e,t,n){"use strict";function r(e,t,n,r,o){return{sel:e,data:t,children:n,text:r,elm:o,key:void 0===t?void 0:t.key}}Object.defineProperty(t,"__esModule",{value:!0}),t.vnode=r,t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.array=Array.isArray,t.primitive=function(e){return"string"==typeof e||"number"==typeof e}},function(e,t,n){"use strict";function r(e,t){var n,r,o=t.elm,i=e.data.props,a=t.data.props;if((i||a)&&i!==a){for(n in a=a||{},i=i||{})a[n]||delete o[n];for(n in a)r=a[n],i[n]===r||"value"===n&&o[n]===r||(o[n]=r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.propsModule={create:r,update:r},t.default=t.propsModule},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="undefined"!=typeof window&&window.requestAnimationFrame.bind(window)||setTimeout,o=function(e){r(function(){r(e)})},i=!1;function a(e,t,n){o(function(){e[t]=n})}function s(e,t){var n,r,o=t.elm,i=e.data.style,s=t.data.style;if((i||s)&&i!==s){s=s||{};var d="delayed"in(i=i||{});for(r in i)s[r]||("-"===r[0]&&"-"===r[1]?o.style.removeProperty(r):o.style[r]="");for(r in s)if(n=s[r],"delayed"===r&&s.delayed)for(var l in s.delayed)n=s.delayed[l],d&&n===i.delayed[l]||a(o.style,l,n);else"remove"!==r&&n!==i[r]&&("-"===r[0]&&"-"===r[1]?o.style.setProperty(r,n):o.style[r]=n)}}t.styleModule={pre:function(){i=!1},create:s,update:s,destroy:function(e){var t,n,r=e.elm,o=e.data.style;if(o&&(t=o.destroy))for(n in t)r.style[n]=t[n]},remove:function(e,t){var n=e.data.style;if(n&&n.remove){i||(getComputedStyle(document.body).transform,i=!0);var r,o=e.elm,a=0,s=n.remove,d=0,l=[];for(r in s)l.push(r),o.style[r]=s[r];for(var u=getComputedStyle(o)["transition-property"].split(", ");a<u.length;++a)-1!==l.indexOf(u[a])&&d++;o.addEventListener("transitionend",function(e){e.target===o&&--d,0===d&&t()})}else t()}},t.default=t.styleModule},function(e,t,n){"use strict";function r(e,t){var n,r,o=t.elm,i=e.data.class,a=t.data.class;if((i||a)&&i!==a){for(r in a=a||{},i=i||{})a[r]||o.classList.remove(r);for(r in a)(n=a[r])!==i[r]&&o.classList[n?"add":"remove"](r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.classModule={create:r,update:r},t.default=t.classModule},function(e,t,n){"use strict";function r(e,t){var n=e.type,r=t.data.on;r&&r[n]&&function e(t,n,r){if("function"==typeof t)t.call(n,r,n);else if("object"==typeof t)if("function"==typeof t[0])if(2===t.length)t[0].call(n,t[1],r,n);else{var o=t.slice(1);o.push(r),o.push(n),t[0].apply(n,o)}else for(var i=0;i<t.length;i++)e(t[i],n,r)}(r[n],t,e)}function o(e,t){var n,o=e.data.on,i=e.listener,a=e.elm,s=t&&t.data.on,d=t&&t.elm;if(o!==s){if(o&&i)if(s)for(n in o)s[n]||a.removeEventListener(n,i,!1);else for(n in o)a.removeEventListener(n,i,!1);if(s){var l=t.listener=e.listener||function e(t){r(t,e.vnode)};if(l.vnode=t,o)for(n in s)o[n]||d.addEventListener(n,l,!1);else for(n in s)d.addEventListener(n,l,!1)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.eventListenersModule={create:o,update:o,destroy:o},t.default=t.eventListenersModule},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/[A-Z]/g;function o(e,t){var n,o=t.elm,i=e.data.dataset,a=t.data.dataset;if((i||a)&&i!==a){i=i||{},a=a||{};var s=o.dataset;for(n in i)a[n]||(s?n in s&&delete s[n]:o.removeAttribute("data-"+n.replace(r,"-$&").toLowerCase()));for(n in a)i[n]!==a[n]&&(s?s[n]=a[n]:o.setAttribute("data-"+n.replace(r,"-$&").toLowerCase(),a[n]))}}t.datasetModule={create:o,update:o},t.default=t.datasetModule},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="http://www.w3.org/1999/xlink",o="http://www.w3.org/XML/1998/namespace",i=58,a=120;function s(e,t){var n,s=t.elm,d=e.data.attrs,l=t.data.attrs;if((d||l)&&d!==l){for(n in d=d||{},l=l||{}){var u=l[n];d[n]!==u&&(!0===u?s.setAttribute(n,""):!1===u?s.removeAttribute(n):n.charCodeAt(0)!==a?s.setAttribute(n,u):n.charCodeAt(3)===i?s.setAttributeNS(o,n,u):n.charCodeAt(5)===i?s.setAttributeNS(r,n,u):s.setAttribute(n,u))}for(n in d)n in l||s.removeAttribute(n)}}t.attributesModule={create:s,update:s},t.default=t.attributesModule},function(e,t,n){const r=n(1),o=n(0).default,{HomologDetails:i}=n(13),{fetchHomologs:a}=n(19),s=n(2),d=n(20);function l(){const e=this;if(e.loading)return o("p.muted","Loading..");if(!e.data||!e.data.length)return o("div","");const t=e.currentPage*e.pageSize,n=[];for(let r=0;r<t&&r<e.data.length;++r)n.push(u(e,e.data[r])),n.push(c(e,e.data[r],5));return o("div",[o("h2.mt3","RefSeq Homologs"),o("table.table-lined",[o("thead",[o("tr",[o("th.sticky",""),f(e,"ANI Distance"),f(e,"Scientific Name"),f(e,"Source")])]),o("tbody",n)]),s(!e.hasMore,()=>o("p.muted","No more results.")),s(e.hasMore,()=>{const t=e.data.length-this.currentPage*this.pageSize;return o("div",[o("button.btn.mt2",{on:{click:()=>e.nextPage()}},["Load more "]),o("span.muted.inline-block.ml1",[t," left"])])})])}function u(e,t){const{dist:n,namespaceid:r,sciname:i,sourceid:a}=t;return o("tr",{key:a,class:{expanded:t.expanded,expandable:t.details.data.kbase_id},on:{click:()=>{t.details.data.kbase_id&&(t.expanded=!t.expanded,e._render())}}},[o("td",[s(t.details.data.kbase_id,()=>o("span.expand-icon",t.expanded?"âˆ’":"+"))]),o("td.bold",[n]),o("td",[i||a]),o("td",[r.replace(/_/g," ")])])}function c(e,t,n){return o("tr.expandable-sibling",{key:t.sourceid+"-details",class:{"expanded-sibling":t.expanded}},[o("td",{props:{colSpan:n}},[t.details.view()])])}function f(e,t){const n=e.sortCol===t;return o("th.sortable.sticky",{class:{sorting:n},on:{click:()=>{e.sortByColumn(t)}}},[o("span",[t]),s(n,()=>o("span.arrow.inline-block.ml1",{class:{"arrow-down":"asc"===e.sortDir,"arrow-up":"desc"===e.sortDir}}))])}e.exports={HomologTable:function(){return r({upa:null,data:[],currentPage:1,pageSize:30,sortable:{"Knowledge Score":!0},sortCol:"ANI Distance",sortDir:"asc",loading:!1,hasMore:!1,sorters:{"ANI Distance":(e,t)=>d(Number(e.dist),Number(t.dist)),"Scientific Name":(e,t)=>d(e.sciname||e.sourceid,t.sciname||t.sourceid),"Knowledge Score":(e,t)=>{const n=isNaN(e.knowledge_score)?0:Number(e.knowledge_score),r=isNaN(t.knowledge_score)?0:Number(t.knowledge_score);return d(n,r)},Source:(e,t)=>d(e.source,t.source)},sortByColumn(e){const t=this.sortCol===e;if(t&&"asc"===this.sortDir?this.sortDir="desc":(this.sortDir="asc",this.sortCol=e),this.sortCol){let t=this.sorters[e];"desc"===this.sortDir&&(n=t,t=function(e,t){const r=n(e,t);return-r}),this.data.sort(t)}var n;this._render()},nextPage(){this.hasMore&&(this.currentPage+=1,this.hasMore=this.currentPage*this.pageSize<this.data.length,this._render())},fetch(e){this.upa=e.replace(/:/g,"/"),this.loading=!0,a(this.upa).then(e=>(this.loading=!1,this.currentPage=1,e&&e.length?(this.data=e,this.hasMore=this.data.length>this.pageSize):(this.data=[],this.hasMore=!1),this.data)).then(e=>e&&e.length?(e=e.map(e=>(e.details=i(e),e)),this.data=e,e):[]).catch(e=>{console.error(e)}).finally(()=>{this.loading=!1,this._render()})},view:l})}}},function(e,t,n){const r=n(1),o=n(0).default,i=n(14),a=n(15),s=n(16),d=n(18);function l(){const e=window._env.kbaseRoot+"/#dataview/"+this.data.kbase_id,t="https://www.ncbi.nlm.nih.gov/assembly/"+this.data.sourceid;return o("div.p1",[d("Assembly page",this.data.sciname||this.data.sourceid,e),d("RefSeq page",this.data.sourceid,t),u(this)])}function u(e){return e.references.loading?o("p.p1.muted","Loading references..."):e.references.data&&e.references.data.length?o("div.p1",[o("h3.h3-5.my1","Referencing Objects"),o("table.table-lined.table-lined-gray",[o("thead",[o("tr",[o("th","Type"),o("th","Name"),o("th","Creator"),o("th","Date")])]),o("tbody",e.references.data.map(e=>(function(e,t){const n=s(t);return o("tr",{key:t._key},[o("td",o("span.bold",i(t.ws_type))),o("td",[o("a",{props:{href:n.obj,target:"_blank"}},[t.obj_name])]),o("td",t.owner),o("td",a(t.save_date))])})(0,e)))])]):o("p.p1.muted","No additional references found for this result.")}e.exports={HomologDetails:function(e){return r({references:{fetched:!1,data:[],currentPage:0,pageSize:10,loading:!1},data:e,view:l})}}},function(e,t){e.exports=function(e){const t=e.match(/^.+\.(.+)-.+$/);return t?t[1]:e}},function(e,t){e.exports=function(e){try{const t=new Date(Date.parse(e)),n=t.toLocaleDateString("en-US");return"Invalid Date"===n?e:n}catch(t){return e}}},function(e,t,n){const r=n(17);e.exports=function(e){const t=window._env.kbaseRoot,n=t+"/#dataview/",o=t+"/#spec/type/",i={};e.ws_type&&(i.type=o+e.ws_type);e.upa?i.obj=n+e.upa:e._key&&(i.obj=n+r(e._key));e.workspace_id&&(i.narrative=`https://narrative.kbase.us/narrative/ws.${e.workspace_id}.obj.1`);e.owner&&(i.owner=t+"/#people/"+e.owner);return i}},function(e,t){e.exports=(e=>e.replace(/:/g,"/"))},function(e,t,n){const r=n(0).default;e.exports=function(e,t,n){let o;return o=n?r("a.inline-block.w-text,.text-ellipsis.mw-32",{props:{href:n,target:"_blank"}},t):r("span.inline-block.ml3.text-ellipsis.mw-32rem",t),r("div.px1",[r("p.m0.py1.border-bottom.light-border",[r("span.bold.w-12rem.mr3.inline-block",e),o])])}},function(e,t){function n(e,t){const n=window._env.authToken,r=window._env.relEngURL.replace(/\/$/,"")+"/api/v1/query_results/"+function(e){const t=[];for(let n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return"?"+t.join("&")}(t),o={};return n&&(o.Authorization=n),window.fetch(r,{method:"POST",headers:o,mode:"cors",body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{if(e&&e.results)return e;if(e&&e.error)throw new Error(e.error)})}e.exports={fetchLinkedObjs:function(e,t){return n({obj_key:e,owners:!1,types:[t.type],show_private:!0,show_public:!0,offset:t.offset,results_limit:t.limit},{stored_query:"wsprov_fetch_linked_objects"})},fetchHomologs:function(e,t){const n=window._env.sketchURL,r={method:"get_homologs",params:{ws_ref:e,n_max_results:500}},o={};window._env.authToken&&(o.Authorization=window._env.authToken);return window.fetch(n,{method:"POST",headers:o,mode:"cors",body:JSON.stringify(r)}).then(e=>e.json()).then(function(e){if(e&&e.result&&e.result.distances&&e.result.distances.length)return e.result.distances})},fetchTypeCounts:function(e){return n({obj_key:e,owners:[],type:"",show_private:!0,show_public:!0},{stored_query:"wsprov_count_linked_object_types"})},fetchKnowledgeScores:function(e){return n({obj_ids:e,prop:"knowledge_score"},{stored_query:"wsprov_fetch_obj_field",batch_size:500})},fetchReferences:function(e){return n({obj_key:e,result_limit:10,offset:0},{stored_query:"wsprov_fetch_references"})}}},function(e,t){e.exports=function(e,t){return e>t?1:e<t?-1:0}},function(e,t,n){"use strict";function r(e,t,n,r,o){return{sel:e,data:t,children:n,text:r,elm:o,key:void 0===t?void 0:t.key}}n.r(t);var o=r,i=Array.isArray;function a(e){return"string"==typeof e||"number"==typeof e}var s={createElement:function(e){return document.createElement(e)},createElementNS:function(e,t){return document.createElementNS(e,t)},createTextNode:function(e){return document.createTextNode(e)},createComment:function(e){return document.createComment(e)},insertBefore:function(e,t,n){e.insertBefore(t,n)},removeChild:function(e,t){e.removeChild(t)},appendChild:function(e,t){e.appendChild(t)},parentNode:function(e){return e.parentNode},nextSibling:function(e){return e.nextSibling},tagName:function(e){return e.tagName},setTextContent:function(e,t){e.textContent=t},getTextContent:function(e){return e.textContent},isElement:function(e){return 1===e.nodeType},isText:function(e){return 3===e.nodeType},isComment:function(e){return 8===e.nodeType}};function d(e,t,n){var o,s,d,l={};if(void 0!==n?(l=t,i(n)?o=n:a(n)?s=n:n&&n.sel&&(o=[n])):void 0!==t&&(i(t)?o=t:a(t)?s=t:t&&t.sel?o=[t]:l=t),void 0!==o)for(d=0;d<o.length;++d)a(o[d])&&(o[d]=r(void 0,void 0,void 0,o[d],void 0));return"s"!==e[0]||"v"!==e[1]||"g"!==e[2]||3!==e.length&&"."!==e[3]&&"#"!==e[3]||function e(t,n,r){if(t.ns="http://www.w3.org/2000/svg","foreignObject"!==r&&void 0!==n)for(var o=0;o<n.length;++o){var i=n[o].data;void 0!==i&&e(i,n[o].children,n[o].sel)}}(l,o,e),r(e,l,o,s,void 0)}function l(e,t){t.elm=e.elm,e.data.fn=t.data.fn,e.data.args=t.data.args,t.data=e.data,t.children=e.children,t.text=e.text,t.elm=e.elm}function u(e){var t=e.data;l(t.fn.apply(void 0,t.args),e)}function c(e,t){var n,r=e.data,o=t.data,i=r.args,a=o.args;if(r.fn===o.fn&&i.length===a.length){for(n=0;n<a.length;++n)if(i[n]!==a[n])return void l(o.fn.apply(void 0,a),t);l(e,t)}else l(o.fn.apply(void 0,a),t)}var f=function(e,t,n,r){return void 0===r&&(r=n,n=t,t=void 0),d(e,{key:t,hook:{init:u,prepatch:c},fn:n,args:r})};function p(e){return void 0===e}function h(e){return void 0!==e}n.d(t,"init",function(){return b}),n.d(t,"h",function(){return d}),n.d(t,"thunk",function(){return f});var v=o("",{},[],void 0,void 0);function m(e,t){return e.key===t.key&&e.sel===t.sel}function g(e,t,n){var r,o,i,a={};for(r=t;r<=n;++r)null!=(i=e[r])&&void 0!==(o=i.key)&&(a[o]=r);return a}var y=["create","update","remove","destroy","pre","post"];function b(e,t){var n,r,d={},l=void 0!==t?t:s;for(n=0;n<y.length;++n)for(d[y[n]]=[],r=0;r<e.length;++r){var u=e[r][y[n]];void 0!==u&&d[y[n]].push(u)}function c(e,t){return function(){if(0==--t){var n=l.parentNode(e);l.removeChild(n,e)}}}function f(e,t){var n,r=e.data;void 0!==r&&h(n=r.hook)&&h(n=n.init)&&(n(e),r=e.data);var o=e.children,s=e.sel;if("!"===s)p(e.text)&&(e.text=""),e.elm=l.createComment(e.text);else if(void 0!==s){var u=s.indexOf("#"),c=s.indexOf(".",u),m=u>0?u:s.length,g=c>0?c:s.length,y=-1!==u||-1!==c?s.slice(0,Math.min(m,g)):s,b=e.elm=h(r)&&h(n=r.ns)?l.createElementNS(n,y):l.createElement(y);for(m<g&&b.setAttribute("id",s.slice(m+1,g)),c>0&&b.setAttribute("class",s.slice(g+1).replace(/\./g," ")),n=0;n<d.create.length;++n)d.create[n](v,e);if(i(o))for(n=0;n<o.length;++n){var w=o[n];null!=w&&l.appendChild(b,f(w,t))}else a(e.text)&&l.appendChild(b,l.createTextNode(e.text));h(n=e.data.hook)&&(n.create&&n.create(v,e),n.insert&&t.push(e))}else e.elm=l.createTextNode(e.text);return e.elm}function b(e,t,n,r,o,i){for(;r<=o;++r){var a=n[r];null!=a&&l.insertBefore(e,f(a,i),t)}}function w(e){var t,n,r=e.data;if(void 0!==r){for(h(t=r.hook)&&h(t=t.destroy)&&t(e),t=0;t<d.destroy.length;++t)d.destroy[t](e);if(void 0!==e.children)for(n=0;n<e.children.length;++n)null!=(t=e.children[n])&&"string"!=typeof t&&w(t)}}function _(e,t,n,r){for(;n<=r;++n){var o=void 0,i=void 0,a=void 0,s=t[n];if(null!=s)if(h(s.sel)){for(w(s),i=d.remove.length+1,a=c(s.elm,i),o=0;o<d.remove.length;++o)d.remove[o](s,a);h(o=s.data)&&h(o=o.hook)&&h(o=o.remove)?o(s,a):a()}else l.removeChild(e,s.elm)}}function k(e,t,n){var r,o;h(r=t.data)&&h(o=r.hook)&&h(r=o.prepatch)&&r(e,t);var i=t.elm=e.elm,a=e.children,s=t.children;if(e!==t){if(void 0!==t.data){for(r=0;r<d.update.length;++r)d.update[r](e,t);h(r=t.data.hook)&&h(r=r.update)&&r(e,t)}p(t.text)?h(a)&&h(s)?a!==s&&function(e,t,n,r){for(var o,i,a,s=0,d=0,u=t.length-1,c=t[0],h=t[u],v=n.length-1,y=n[0],w=n[v];s<=u&&d<=v;)null==c?c=t[++s]:null==h?h=t[--u]:null==y?y=n[++d]:null==w?w=n[--v]:m(c,y)?(k(c,y,r),c=t[++s],y=n[++d]):m(h,w)?(k(h,w,r),h=t[--u],w=n[--v]):m(c,w)?(k(c,w,r),l.insertBefore(e,c.elm,l.nextSibling(h.elm)),c=t[++s],w=n[--v]):m(h,y)?(k(h,y,r),l.insertBefore(e,h.elm,c.elm),h=t[--u],y=n[++d]):(void 0===o&&(o=g(t,s,u)),p(i=o[y.key])?(l.insertBefore(e,f(y,r),c.elm),y=n[++d]):((a=t[i]).sel!==y.sel?l.insertBefore(e,f(y,r),c.elm):(k(a,y,r),t[i]=void 0,l.insertBefore(e,a.elm,c.elm)),y=n[++d]));(s<=u||d<=v)&&(s>u?b(e,null==n[v+1]?null:n[v+1].elm,n,d,v,r):_(e,t,s,u))}(i,a,s,n):h(s)?(h(e.text)&&l.setTextContent(i,""),b(i,null,s,0,s.length-1,n)):h(a)?_(i,a,0,a.length-1):h(e.text)&&l.setTextContent(i,""):e.text!==t.text&&(h(a)&&_(i,a,0,a.length-1),l.setTextContent(i,t.text)),h(o)&&h(r=o.postpatch)&&r(e,t)}}return function(e,t){var n,r,i,a=[];for(n=0;n<d.pre.length;++n)d.pre[n]();for(function(e){return void 0!==e.sel}(e)||(e=function(e){var t=e.id?"#"+e.id:"",n=e.className?"."+e.className.split(" ").join("."):"";return o(l.tagName(e).toLowerCase()+t+n,{},[],void 0,e)}(e)),m(e,t)?k(e,t,a):(r=e.elm,i=l.parentNode(r),f(t,a),null!==i&&(l.insertBefore(i,t.elm,l.nextSibling(r)),_(i,[e],0,0))),n=0;n<a.length;++n)a[n].data.hook.insert(a[n]);for(n=0;n<d.post.length;++n)d.post[n]();return t}}}]);